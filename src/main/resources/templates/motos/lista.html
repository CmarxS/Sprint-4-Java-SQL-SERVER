<!DOCTYPE html>
<html lang="pt-br"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{fragments/header :: head('Motos')}"></head>
<body>
<div th:replace="~{fragments/menu :: menu('motos')}"></div>

<main class="wrap">
    <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
            <h2>Motos</h2>

            <!-- Botão "Nova Moto" só para ADMIN -->
            <span sec:authorize="hasRole('ADMIN')">
        <a class="btn primary" th:href="@{/motos/novo}">Nova Moto</a>
      </span>
        </div>

        <table>
            <thead>
            <tr>
                <th>ID</th>
                <th>Placa</th>
                <th>Modelo</th>
                <th>Status</th>
                <th>Ações</th>
            </tr>
            </thead>

            <tbody>
            <tr th:each="m : ${motos}">
                <td th:text="${m.id}">1</td>
                <td th:text="${m.placa}">ABC1D23</td>
                <td th:text="${m.modelo}">Honda CG 160</td>
                <td th:text="${m.status}">No pátio</td>

                <td class="actions">
                    <!-- Ações só para ADMIN -->
                    <span sec:authorize="hasRole('ADMIN')">
            <a th:href="@{|/motos/editar/${m.id}|}">Editar</a>
            <a th:href="@{|/motos/excluir/${m.id}|}"
               onclick="return confirm('Confirma excluir?')">Excluir</a>
          </span>

                    <!-- Para OPERADOR, não mostra botões -->
                    <span sec:authorize="!hasRole('ADMIN')">-</span>
                </td>
            </tr>

            <tr th:if="${#lists.isEmpty(motos)}">
                <td colspan="5">Nenhum registro.</td>
            </tr>
            </tbody>
        </table>
    </div>
</main>

<div th:replace="~{fragments/footer :: footer}"></div>
</body>
</html>
